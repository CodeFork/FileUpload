function UploadFile(n,t,i,r,u){var e=new FormData,f;e.append("file",n,n.customName||n.name);f=new XMLHttpRequest;f.onreadystatechange=function(n){var t=n.target,u;t.readyState==XMLHttpRequest.DONE&&(t.status==200?(u=f.responseText,i(u)):r!=null&&r(f.status,f.statusText))};r!=null&&(f.onerror=function(n){r(500,n.message)});u!=null&&(f.upload.onprogress=function(n){u(n.loaded,n.total)});f.open("POST",t);f.send(e)}function IsDraggableSupported(){var n=document.createElement("div");return"draggable"in n||"ondragstart"in n&&"ondrop"in n}function IsPasteSupport(){return"onpaste"in document}function Initialize(){function l(){if(i!==null){var n=i.dataset.reloadUrl;fetch(n).then(function(n){n.text().then(function(n){var r=document.createElement("div"),t;r.innerHTML=n;s!==null?(t=r.querySelector(".browser table tbody"),s.innerHTML=t.innerHTML):(t=r.querySelector(".browser"),i.innerHTML=t.innerHTML)})})}}function h(){for(var h,e="",t=0;t<n.length;t++){var s=n[t],r=s.customName||s.name,i=u.dataset.downloadUrl,f="";i!=""?(h=i+(i[i.length-1]=="/"?"":"/")+r,f="<a href='"+h+"' target='_blank'>"+r+"<\/a>"):f=r;e+="<div data-file-index='"+t+"' class='file'><div class='file-name'>"+f+"<\/div><div class='file-state'>Waiting<\/div><div class='clear'><\/div><div class='file-progress' style='width: 0%;'><\/div><\/div>"}o.innerHTML=e}function r(){if(t++,n.length>t){var s=null,f=null,i=o.querySelector("[data-file-index='"+t+"']");i!=null&&(i.classList.add("file-current"),s=i.querySelector(".file-progress"),f=i.querySelector(".file-state"));UploadFile(n[t],u.action,function(){i!=null&&(i.classList.remove("file-current"),i.classList.add("file-done"),f.innerHTML="Done");r()},function(){i!=null&&(i.classList.remove("file-current"),i.classList.add("file-error"),f.innerHTML="Failed");r()},function(n,t){var i=100/t*n;s.style.width=i+"%";f.innerHTML=Math.floor(i)+"%"})}else e.removeAttribute("disabled"),u.reset(),l()}var u,f,e,o,n=[],t=-1,i,s,c;Container=document.getElementById("upload-container");u=document.getElementById("form");f=document.getElementById("files");f.addEventListener("change",function(){e.setAttribute("disabled","disabled");n=f.files;t=-1;h();r()});e=document.getElementById("picker");e.addEventListener("click",function(n){f.click();n.preventDefault()});Container.addEventListener("drag",function(n){n.preventDefault()});Container.addEventListener("dragstart",function(n){n.preventDefault()});Container.addEventListener("dragend",function(n){n.preventDefault()});Container.addEventListener("dragover",function(n){n.preventDefault()});Container.addEventListener("dragenter",function(n){n.preventDefault()});Container.addEventListener("dragleave",function(n){n.preventDefault()});Container.addEventListener("drop",function(i){n=i.dataTransfer.files;t=-1;h();r();i.preventDefault()});o=document.querySelector(".status");IsDraggableSupported()&&document.body.classList.add("dragdrop-supported");IsPasteSupport()&&(document.addEventListener("paste",function(i){var f,o,e,s,u;for(n=i.clipboardData.files,t=-1,f=0;f<n.length;f++)o=n[f],e=o.name.split("."),e[0]=="image"&&(s="file_"+ +new Date,u=prompt("Name the file (without extension):",s),(u==null||u.trim()=="")&&(u=s),e[0]=u,o.customName=e.join("."));h();r();i.preventDefault()}),document.body.classList.add("clipboard-supported"));Container.style.display="block";i=document.querySelector(".browser");i!==null&&(s=i.querySelector("table tbody"),c=i.querySelector(".reload-button"),c!==null&&c.addEventListener("click",l,!1))}